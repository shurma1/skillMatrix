import{t as B,j as e,B as g,z as b,R as C,v as h,C as l,T as P,D as I,d as R,bv as $,J as E}from"./index-C2zTCuKe.js";import{R as j}from"./index-D_6T43LE.js";import{R as y}from"./CheckCircleOutlined-BH__vJpJ.js";import{R as v,S as m}from"./index-CX4mJsSu.js";const{Title:N,Text:T}=P,Q=({user:c,testResult:o,isLoading:a,error:d,onNavigateHome:n,onNavigateLogin:x})=>{const{token:s}=B.useToken();if(!c)return e.jsx(j,{status:"warning",title:"Необходима авторизация",subTitle:"Для просмотра результатов необходимо войти в систему",extra:[e.jsx(g,{type:"primary",onClick:x,children:"Войти"},"login")]});if(a)return e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"50vh"},children:e.jsx(b,{size:"large"})});if(d||!o)return e.jsx(j,{status:"error",title:"Ошибка загрузки результатов",subTitle:"Не удалось загрузить результаты тестирования",extra:[e.jsx(g,{type:"primary",onClick:n,children:"На главную"},"home")]});const i=o.score>=o.needScore,u=Math.round(o.score/o.questions.length*100);return e.jsxs("div",{style:{maxWidth:800,margin:"0 auto",padding:"24px"},children:[e.jsx(j,{status:i?"success":"error",icon:i?e.jsx(y,{style:{color:s.colorSuccess}}):e.jsx(v,{style:{color:s.colorError}}),title:i?"Тест пройден успешно!":"Тест не пройден",subTitle:`Вы набрали ${o.score} из ${o.needScore} необходимых баллов`}),e.jsxs(C,{gutter:16,style:{marginBottom:24},children:[e.jsx(h,{span:8,children:e.jsx(l,{children:e.jsx(m,{title:"Правильных ответов",value:o.score,suffix:`/ ${o.questions.length}`,valueStyle:{color:i?s.colorSuccess:s.colorError}})})}),e.jsx(h,{span:8,children:e.jsx(l,{children:e.jsx(m,{title:"Процент успеха",value:u,suffix:"%",valueStyle:{color:i?s.colorSuccess:s.colorError}})})}),e.jsx(h,{span:8,children:e.jsx(l,{children:e.jsx(m,{title:"Нужно для прохождения",value:o.needScore,suffix:`/ ${o.questions.length}`})})})]}),e.jsx(l,{title:"Детальные результаты",style:{marginBottom:24},children:o.questions.map((t,f)=>{const S=t.answers.filter(r=>r.isTrue),p=t.answers.filter(r=>r.isPicked),k=p.length===S.length&&p.every(r=>r.isTrue);return e.jsxs("div",{style:{marginBottom:24,padding:16,border:`1px solid ${s.colorBorder}`,borderRadius:4,background:s.colorBgContainer},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:12},children:[e.jsxs(N,{level:5,style:{margin:0,marginRight:8},children:["Вопрос ",f+1]}),k?e.jsx(y,{style:{color:s.colorSuccess}}):e.jsx(v,{style:{color:s.colorError}})]}),e.jsx(T,{style:{marginBottom:12,display:"block"},children:t.QuestionText}),e.jsx("div",{children:t.answers.map(r=>e.jsx("div",{style:{padding:"8px 12px",margin:"4px 0",borderRadius:4,backgroundColor:r.isTrue?s.colorSuccessBg:r.isPicked?s.colorWarningBg:s.colorFillTertiary,border:`1px solid ${r.isTrue?s.colorSuccess:r.isPicked?s.colorWarning:s.colorBorder}`},children:e.jsxs(T,{style:{color:r.isTrue?s.colorSuccess:r.isPicked?s.colorWarning:s.colorText},children:[r.answerText,r.isPicked&&!r.isTrue&&" ✗ (ваш ответ)"]})},r.answerId))})]},t.QuestionID)})}),e.jsx("div",{style:{textAlign:"center"},children:e.jsx(g,{type:"primary",size:"large",onClick:n,children:"На главную"})})]})},W=()=>{const{testId:c=""}=I(),o=R(),a=$(u=>u.auth.user),{data:d,isLoading:n,error:x}=E(c,{skip:!c}),s=()=>{o("/")},i=()=>{o("/login")};return e.jsx(Q,{user:a,testResult:d,isLoading:n,error:x,onNavigateHome:s,onNavigateLogin:i})},w=()=>e.jsx(W,{});export{w as default};
