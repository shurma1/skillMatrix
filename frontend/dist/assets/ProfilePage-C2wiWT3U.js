import{j as a,T as f,C as y,h as u,c,B as v,a as E,bV as w,bW as P,r as d,S as U,aA as b,O as p}from"./index-C2zTCuKe.js";import{A as C,g as S,E as A}from"./EditUserModal-DZu4zdMs.js";const{Title:h}=f,M=({user:e,loading:t,initials:i,onEdit:n,onAvatarChange:r})=>a.jsxs("div",{children:[a.jsx(h,{level:3,style:{marginTop:0},children:"Мой профиль"}),a.jsx(y,{children:t||!e?a.jsx(u,{active:!0,avatar:!0,paragraph:{rows:4}}):a.jsxs(c,{gap:32,align:"start",children:[a.jsx(C,{avatarId:e.avatar_id,initials:i,onChange:r}),a.jsx("div",{style:{flex:1},children:a.jsxs(c,{justify:"space-between",align:"start",gap:16,style:{width:"100%"},children:[a.jsxs("div",{style:{minWidth:0},children:[a.jsxs(h,{level:4,style:{marginTop:0,marginBottom:8},children:[e.lastname," ",e.firstname," ",e.patronymic]}),a.jsxs("p",{style:{margin:0},children:[a.jsx("b",{children:"Логин:"})," ",e.login]}),a.jsxs("p",{style:{margin:"4px 0 0"},children:[a.jsx("b",{children:"Email:"})," ",e.email||"—"]})]}),a.jsx(v,{type:"primary",onClick:n,style:{whiteSpace:"nowrap"},children:"Редактировать"})]})})]})})]}),T=()=>{const e=E(),{data:t,isFetching:i}=w(),[n,{isLoading:r}]=P(),[g,l]=d.useState(!1),x=d.useMemo(()=>t?S(t):"",[t]),j=s=>typeof s=="object"&&s&&"data"in s&&typeof s.data?.message=="string"?s.data.message:"Ошибка",o=async s=>{try{await n(s).unwrap(),s.avatar_id&&e(b(s.avatar_id)),p.success("Изменения сохранены"),l(!1)}catch(m){p.error(j(m)||"Ошибка обновления")}};return a.jsxs(U,{direction:"vertical",size:32,style:{width:"100%"},children:[a.jsx(M,{user:t,loading:i,initials:x,onEdit:()=>l(!0),onAvatarChange:s=>o({avatar_id:s})}),a.jsx(A,{open:g,user:t||null,confirmLoading:r,onCancel:()=>l(!1),onSubmit:o})]})},L=()=>a.jsx(T,{});export{L as default};
